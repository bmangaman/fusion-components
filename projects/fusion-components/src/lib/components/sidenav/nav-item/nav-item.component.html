<li class="f-navItem">

  @if (!!href || !!route) {
    @if (!!route) {
      <a
        (click)="toggleExpansion(); setCurrentSelectedNavItem()"
        [routerLink]="route"
        [routerLinkActive]="['f-navItem__link--active', 'f-navItem__link--selected']"
        [routerLinkActiveOptions]="isPathMatchFull ? { exact: true } : { exact: false }"
        [ngClass]="linkCssClasses"
        [attr.id]="id"
        [attr.title]="title | toObservable | async"
        [attr.disabled]="isDisabled"
        [attr.aria-Disabled]="isDisabled"
        [style.paddingLeft.px]="(index * 24) + 16">
        <ng-container *ngTemplateOutlet="linkContent"></ng-container>
      </a>
    } @else {
      <a
        (click)="toggleExpansion(); setCurrentSelectedNavItem()"
        [ngClass]="linkCssClasses"
        [attr.href]="href"
        [attr.id]="id"
        [attr.title]="title | toObservable | async"
        [attr.disabled]="isDisabled"
        [attr.aria-Disabled]="isDisabled"
        [attr.target]="target"
        [style.paddingLeft.px]="(index * 24) + 16">
        <ng-container *ngTemplateOutlet="linkContent"></ng-container>
      </a>
    }
  } @else {
    <button
      (click)="toggleExpansion()"
      [ngClass]="linkCssClasses"
      [attr.id]="id"
      [attr.title]="title | toObservable | async"
      [disabled]="isDisabled"
      [attr.aria-Disabled]="isDisabled">
      <ng-container *ngTemplateOutlet="linkContent"></ng-container>
    </button>
  }


  @if (isExpanded) {
    <div
      class="f-navItem__sub-items-container"
      [@inOutAnimation]
      >
      <ul class="f-sidenav__items f-navItem__sub-items">
        @for (navItem of children; track navItem) {
          @if (navItem) {
            <f-nav-item
              (itemSelected)="setCurrentSelectedNavItem($event)"
              [id]="navItem.id"
              [title]="navItem.title | toObservable | async"
              [text]="navItem.text | toObservable | async"
              [icon]="navItem.icon"
              [isExpanded]="!!navItem.isExpanded"
              [isDisabled]="!!navItem.isDisabled"
              [route]="navItem.route"
              [href]="navItem.href"
              [children]="navItem.children"
              [target]="navItem.target"
              [index]="index + 1">
            </f-nav-item>
          }
        }
      </ul>
    </div>
  }

</li>

<ng-template #linkContent>
  @if (icon) {
    <i [ngClass]="iconCssClasses"></i>
  }
  <span class="f-navItem__text">{{ text | toObservable | async }}</span>
  @if (children?.length) {
    <i class="f-navItem__isExpandable-icon mdi" [ngClass]="isExpanded ? 'mdi-chevron-down' : 'mdi-chevron-right'"></i>
  }
</ng-template>
